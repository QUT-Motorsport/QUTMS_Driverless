FROM qutms_driverless_base:galactic
# qutms_driverless_base generated by qutms_driverless/docker/Makefile

ARG USERNAME
ARG HOST_UID
# dialout group is used for compatability with mac
ARG HOST_GROUP=dialout

WORKDIR /tmp 

# vision_pipeline
COPY ./src/perception/lidar_pipeline/conda_requirements ./requirements.txt
RUN pip3 install -r requirements.txt
RUN rm -f ./requirements.txt

WORKDIR /home/$USERNAME/driverless_ws
USER ${USERNAME}

# run a build
# COPY --chown=${USERNAME}:${HOST_GROUP} ./src/ ./src
# RUN source /opt/ros/foxy/install/setup.bash; \
#     colcon build --symlink-install --packages-up-to \
#         lidar_pipeline \
#         vision_pipeline \
#     && rm -rf ./src
